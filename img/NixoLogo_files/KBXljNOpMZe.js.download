if (self.CavalryLogger) { CavalryLogger.start_js(["TzbNM"]); }

__d('MStoryDoubleTapLike',['BanzaiLogger','DOM','MViewport','Parent','Stratcom','SubscriptionsHandler','csx','cx','getUnboundedScrollPosition','requestAnimationFrame'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';var r='doubleClickLikeOverlay',s="_2r0p",t='ufi-inline-like',u="._5rgr",v='double-tap-to-like-enabled';function w(){this.clickTimeoutID=null;this.isSecondClick=false;this.fromSelf=false;this.touchStarted=false;}w.prototype.$MStoryDoubleTapLike1=function(x){var y=document.getElementById(r);if(y&&y.parentNode)y.parentNode.removeChild(y);y=i.create('div',{id:r,className:s});var z=x.getBoundingClientRect(),aa=p(window);y.style.width=z.width+'px';y.style.height=z.height+'px';y.style.top=z.top+aa.y+'px';y.style.left=z.left+aa.x+'px';return y;};w.prototype.$MStoryDoubleTapLike2=function(x){var y=k.bySelector(x,u),z=i.scry(y,'*',t)[0];if(z){if(z.getAttribute('aria-pressed')!=='true'){z.click();h.log('DoubleTapLikeLoggerConfig',{event:'like_created'});}var aa=this.$MStoryDoubleTapLike1(x);j.appendNode(aa);}};w.prototype.$MStoryDoubleTapLike3=function(x){var y=l.hasSigil(x,v);if(y)return x;return i.scry(x,'*',v)[0];};w.prototype.registerNuxHandler=function(x){var y=new m();y.addSubscriptions(l.listen('click','ufi-inline-like',function(z){var aa,ba=k.bySelector(z.getTarget(),u);if(ba!==null)(function(){var ca=i.scry(ba,'*',v)[0];if(ca!==null)q(function(){x.setContext(ca);x.show();});})();}),x.once('hide',function(){y&&y.release();}));l.listen('m:page:unload',null,function(){l.removeCurrentListener();y&&y.release();});};w.prototype.registerClickHandler=function(x){var y=this.$MStoryDoubleTapLike3(x);if(!y)return;var z=new m();z.addSubscriptions(i.listen(y,'touchstart',null,function(aa){this.touchStarted=true;}.bind(this)),i.listen(y,'touchmove',null,function(aa){this.touchStarted=false;}.bind(this)),i.listen(y,'touchend',null,function(aa){if(!this.touchStarted){aa.kill();return false;}if(this.fromSelf){this.fromSelf=false;return true;}if(!this.isSecondClick){this.isSecondClick=true;this.clickTimeoutID=setTimeout(function(){this.clickTimeoutID=null;this.isSecondClick=false;this.fromSelf=true;aa.getTarget().click();}.bind(this),300);}else{clearTimeout(this.clickTimeoutID);this.clickTimeoutID=null;this.isSecondClick=false;this.$MStoryDoubleTapLike2(x);}aa.kill();return false;}.bind(this)),l.listen('m:page:unload',null,function(){z.release();}));};f.exports=new w();}),null);
__d("XFeedNUXSaveSeenStateController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/feed\/nux\/seen\/save\/",{link_id:{type:"String"},key:{type:"String",required:true},seen:{type:"Bool",defaultValue:false},env:{type:"Enum",enumType:0}});}),null);
__d('MFeedNUXTooltip',['DOM','MRequest','MViewport','Stratcom','SubscriptionsHandler','XFeedNUXSaveSeenStateController','destroyOnUnload','mixInEventEmitter'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={},q,r={},s,t=0,u=100,v=1,w=0;function x(){q=k.listen('scroll',null,z);n(y);}function y(){if(q)q.remove();q=null;window.clearTimeout(s);s=null;}function z(){var ca=j.getHeight();if(s){window.clearTimeout(s);s=null;}for(var da in p){var ea=p[da],fa=ea.getNodes(),ga=ea.getHeadRoom();for(var ha=0;ha<fa.length;ha++){var ia=fa[ha].getBoundingClientRect();if(ia.top>=ga&&ia.bottom<=ca){aa(fa[ha],ea);break;}}}}function aa(ca,da){s=window.setTimeout(function(){if(da.getContext()!==ca){da.setContext(ca);da.show();}},t);}function ba(ca,da,ea,fa){'use strict';if(!p.length)x();if(p[da]||r[da]){ea.destroy();return;}this.$MFeedNUXTooltip1=da;this.$MFeedNUXTooltip2=h.scry(document.getElementById('page'),'*',ca);this.$MFeedNUXTooltip3=ca;this.$MFeedNUXTooltip4=w;this.$MFeedNUXTooltip5=ea;this.$MFeedNUXTooltip6=fa===0?0:fa||u;p[da]=this;var ga=new l();ga.addSubscriptions(this.$MFeedNUXTooltip5.addListener('show',this.emit.bind(this,'show')),this.$MFeedNUXTooltip5.addListener('hide',function(){this.emit('hide');ga.release();}.bind(this)));z();}ba.prototype.destroy=function(){'use strict';delete p[this.$MFeedNUXTooltip1];if(!Object.keys(p).length)y();};ba.prototype.getContext=function(){'use strict';return this.$MFeedNUXTooltip5.getContext();};ba.prototype.getNodes=function(){'use strict';return this.$MFeedNUXTooltip2;};ba.prototype.getHeadRoom=function(){'use strict';return this.$MFeedNUXTooltip6;};ba.prototype.getIsUnseen=function(){'use strict';return this.$MFeedNUXTooltip4===w;};ba.prototype.setContext=function(ca){'use strict';this.$MFeedNUXTooltip5&&this.$MFeedNUXTooltip5.setContext(ca);};ba.prototype.show=function(){'use strict';if(!this.$MFeedNUXTooltip5||this.$MFeedNUXTooltip4===v)return;r[this.$MFeedNUXTooltip1]=true;this.$MFeedNUXTooltip4=v;this.$MFeedNUXTooltip5.show();var ca=m.getURIBuilder().setString('key',this.$MFeedNUXTooltip1).setBool('seen',true);new i(ca.getURI()).setMethod('POST').send();this.destroy();};ba.prototype.hide=function(){'use strict';this.$MFeedNUXTooltip5&&this.$MFeedNUXTooltip5.hide();};o(ba,{show:true,hide:true});f.exports=ba;}),null);
__d('MFeedReactionsNUX',['BanzaiLogger','MLegacyDataStore','MLiveData','Stratcom','SubscriptionsHandler','requestAnimationFrame'],(function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';function n(p,q){var r,s=q&&q.isCommentNUX;if(p)(function(){var t=new l();t.addSubscriptions(k.listen('click','like-reaction-flyout',function(u){var v,w=u.getNode('like-reaction-flyout'),x=u.getNode('feed-ufi-comments');if(!w||x)return;var y=i.get(w);if(s&&!y.isComment||!s&&y.isComment)return;var z=y.feedback_target||y.feedbackTarget;if(z)(function(){var aa=j.get(z);t.addSubscriptions(aa.listen('change',function(){if(aa.getData().has_viewer_liked)m(function(){p.setContext(u.getTarget());p.show();o(z);});}));})();}),p.once('hide',function(){t.release();}));if(!s)t.addSubscriptions(k.listen('click','reactions-bling-bar',function(u){var v=u.getNode('mufi-inline').querySelector('a[data-sigil*="like-reaction-flyout"]');if(v){var w=u.getNode('feed-ufi-metadata'),x=i.get(w).feedback_target.toString();o(x);p.setContext(v);p.show();u.kill();}}));k.listen('m:page:unload',null,function(){k.removeCurrentListener();t.release();});})();}function o(p){h.log('WebReactionsNuxLoggerConfig',{feedback_id:p,'interface':'mTouch'});}f.exports.init=n;}),null);