if (self.CavalryLogger) { CavalryLogger.start_js(["6KicA"]); }

__d("MPageletTypes",[],(function a(b,c,d,e,f,g){f.exports={CHROME:"chrome",CONTENT:"content"};}),null);
__d("XFeedNewStoriesBadgeController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/feed\/badge\/",{});}),null);
__d('MFeedJewel',['CSS','DOM','formatNumber','MHistory','MJewel','MJewels','MPageController','MRequest','MURI','Stratcom','SubscriptionsHandler','XFeedNewStoriesBadgeController','$','ScriptPath'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v,w,x,y,z,aa,ba=0,ca=9,da=15000;function ea(pa){h.conditionClass(y,'popoverOpen',true);}function fa(pa){h.conditionClass(y,'popoverOpen',false);}function ga(){if(x)return;x=new r();x.addSubscriptions(i.listen(t(l.JEWEL_NAV_NODE_ID),'click','feed',ja));x.addSubscriptions(q.listen('m:history:change',null,ia));}function ha(){x&&x.release();x=null;}function ia(pa){var qa=pa.getData().soft;for(var ra=0,sa=Object.keys(m);ra<sa.length;ra++)if(m[sa[ra]]===qa){fa();return;}ea();}function ja(pa){var qa=pa.getNode('icon').getAttribute('href');if(new p(qa).normalize().toString()===new p(k.getPath()).normalize().toString()){pa.kill();n.reload({reloaded:true});}u.set('topbar_feed');}function ka(pa){i.setContent(v,j.withMaxLimit(pa,ca));h.conditionClass(y,'noCount',!pa);h.conditionClass(y,'hasCount',pa);}function la(){if(ba>ca)return;clearTimeout(aa);aa=setTimeout(function(){ma();},da);}function ma(){var pa=s.getURIBuilder();z=new o(pa.getURI().toString());z.listen('done',function(qa){ba=qa.payload.count;ka(qa.payload.count);});z.listen('finally',function(){z=null;la();});z.send();}function na(){ka();clearTimeout(aa);aa=null;ba=0;}function oa(pa,qa){if(w)return;w=true;y=pa;v=i.find(y,'span','count');q.listen('m:homepage:load',null,function(){ea();ga();if(v)na();});q.listen('m:homepage:unload',null,function(){fa();ha();if(v)la();});if(qa){ga();}else if(v)la();}f.exports={init:oa};}),null);
__d('MGenericJewel',['CSS','DOM','MHistory','MJewel','MViewport','MJewels','Stratcom','ScriptPath','$'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q={};function r(s,t,u){if(q[s])return;q[s]=true;var v,w;i.listen(p(k.JEWEL_NAV_NODE_ID),'click',s,function(x){if(x.getNode('icon')){x.prevent();if(!v){j.pushSoftState(s);n.invoke('MGenericJewel::clicked',s,{open:true});}else if(s===m.SEARCH)n.invoke('m:chrome:tab:show',s,{open:true});}o.set('topbar_'+s);});n.listen('m:history:change',null,function(x){var y=x.getData().soft===s;if(!y&&(v||w))n.invoke('m:chrome:tab:hide',s);h.conditionClass(t,'popoverOpen',y);if(u){h.conditionClass(u,'popover_hidden',!y);h.conditionClass(u,'popover_visible',y);if(y)u.style.minHeight=l.getUseableHeight()+'px';}if(y&&!v)n.invoke('m:chrome:tab:show',s);w=x.getData().soft===undefined;v=y;});}f.exports={init:r};}),null);
__d('MInitJewelCounts',['Stratcom'],(function a(b,c,d,e,f,g,h){'use strict';var i=[],j=false;function k(n){h.invoke('m:jewels:init-counts',null,n);}function l(n){k(n);if(!j)i.push(n);}function m(){if(j)return;j=true;var n=i.splice(0,i.length);n.forEach(function(o){k(o);});}f.exports={main:l,replayMissedEvents:m};}),null);
__d('FriendingSurfaceVisitationTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g,h,i,j){'use strict';function k(){this.clear();}k.prototype.log=function(){i.log('logger:FriendingSurfaceVisitationLoggerConfig',this.$FriendingSurfaceVisitationTypedLogger1,h.BASIC);};k.prototype.logVital=function(){i.log('logger:FriendingSurfaceVisitationLoggerConfig',this.$FriendingSurfaceVisitationTypedLogger1,h.VITAL);};k.prototype.clear=function(){this.$FriendingSurfaceVisitationTypedLogger1={};return this;};k.prototype.updateData=function(m){this.$FriendingSurfaceVisitationTypedLogger1=babelHelpers['extends']({},this.$FriendingSurfaceVisitationTypedLogger1,m);return this;};k.prototype.setAppVersion=function(m){this.$FriendingSurfaceVisitationTypedLogger1.app_version=m;return this;};k.prototype.setBadgeCount=function(m){this.$FriendingSurfaceVisitationTypedLogger1.badge_count=m;return this;};k.prototype.setClientTimestamp=function(m){this.$FriendingSurfaceVisitationTypedLogger1.client_timestamp=m;return this;};k.prototype.setRawRefTab=function(m){this.$FriendingSurfaceVisitationTypedLogger1.raw_ref_tab=m;return this;};k.prototype.setRawTab=function(m){this.$FriendingSurfaceVisitationTypedLogger1.raw_tab=m;return this;};k.prototype.setRefPage=function(m){this.$FriendingSurfaceVisitationTypedLogger1.ref_page=m;return this;};k.prototype.setSurface=function(m){this.$FriendingSurfaceVisitationTypedLogger1.surface=m;return this;};k.prototype.setTargetProfileID=function(m){this.$FriendingSurfaceVisitationTypedLogger1.target_profile_id=m;return this;};k.prototype.setVC=function(m){this.$FriendingSurfaceVisitationTypedLogger1.vc=m;return this;};var l={app_version:true,badge_count:true,client_timestamp:true,raw_ref_tab:true,raw_tab:true,ref_page:true,surface:true,target_profile_id:true,vc:true};f.exports=k;}),null);
__d('XFBConfirmationCliffTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g,h,i,j){'use strict';function k(){this.clear();}k.prototype.log=function(){i.log('logger:XFBConfirmationCliffLoggerConfig',this.$XFBConfirmationCliffTypedLogger1,h.BASIC);};k.prototype.logVital=function(){i.log('logger:XFBConfirmationCliffLoggerConfig',this.$XFBConfirmationCliffTypedLogger1,h.VITAL);};k.prototype.clear=function(){this.$XFBConfirmationCliffTypedLogger1={};return this;};k.prototype.updateData=function(m){this.$XFBConfirmationCliffTypedLogger1=babelHelpers['extends']({},this.$XFBConfirmationCliffTypedLogger1,m);return this;};k.prototype.setCliffCaller=function(m){this.$XFBConfirmationCliffTypedLogger1.cliff_caller=m;return this;};k.prototype.setError=function(m){this.$XFBConfirmationCliffTypedLogger1.error=m;return this;};k.prototype.setSurface=function(m){this.$XFBConfirmationCliffTypedLogger1.surface=m;return this;};k.prototype.updateExtraData=function(m){m=j(i.serializeMap(m));i.checkExtraDataFieldNames(m,l);this.$XFBConfirmationCliffTypedLogger1=babelHelpers['extends']({},this.$XFBConfirmationCliffTypedLogger1,m);return this;};k.prototype.addToExtraData=function(m,n){var o={};o[m]=n;return this.updateExtraData(o);};var l={cliff_caller:true,error:true,surface:true};f.exports=k;}),null);
__d("XMessagesJewelContentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/mobile\/messages\/jewel\/content\/",{spinner_id:{type:"String",required:true}});}),null);
__d("XNotificationJewelContentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/mobile\/notifications\/jewel\/content\/",{spinner_id:{type:"String",required:true}});}),null);
__d('MJewelSet',['BanzaiLogger','Banzai','ChannelEventType','CSS','MLegacyDataStore','DOM','EventListener','FriendingSurfaceVisitationTypedLogger','MFriendRequestIHEventLogger','MarauderLogger','MessagingEvent','MInitJewelCounts','MJewel','MJewels','MLogState','MPymkFunnelLogger','MRequest','MTouchChannelManager','MTouchDisplayNoneTestGK','MURI','MViewport','Popover','ScriptPath','Stratcom','XFBConfirmationCliffTypedLogger','XMessagesJewelContentController','XNotificationJewelContentController','fbt','throttle'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja){var ka={_viewerID:null,_requestsJewel:null,_messagesJewel:null,_notificationsJewel:null,_unseenNotificationIds:{},_jewelClickLogListener:null,_messengerCliff:false,_haveInitializedJewels:false,_pymkAndRequestImpressionLogged:false,MSG_ID_PREFIX:'msg_',OTHER_USER_FBID_PREFIX:'other_user_fbid_',THREAD_FBID_PREFIX:'thread_fbid_',NOTIF_ID_PREFIX:'notif_',JEWEL_NAV_NODE_ID:'mJewelNav',JEWEL_NAV_CACHE_KEY:'mJewelNavKey',JEWEL_MSG_LIST:'mJewelMsgThreadContents',_lazyLoadNotificationsReq:null,_lazyLoadMessagesReq:null,_hasCombinedTab:false,_diodeBadgeableQPCount:0,createJewels:function la(ma){if(ma.showRequests){ka._requestsJewel=new t('requests',{pos:v.CLICK_POSITION_REQUESTS_FLYOUT,softState:u.REQUESTS},'friends_jewel_module');ka._requestsJewel.listen('cleared',ka._markRequestsRead);ka._requestsJewel.listen('jewel_click',ka._logRequestsJewelClick);}if(ma.hasCombinedTab)ka._hasCombinedTab=true;ka._messagesJewel=new t('messages',{contentsSigil:ka.JEWEL_MSG_LIST,pos:v.CLICK_POSITION_MESSAGES_FLYOUT,softState:u.MESSAGES},'messages_jewel_module');ka._messagesJewel.listen('cleared',ka._markMessagesRead);ka._notificationsJewel=new t('notifications',{pos:v.CLICK_POSITION_NOTIFICATIONS_FLYOUT,softState:u.NOTIFICATIONS},'notifications_jewel_module');ka._notificationsJewel.listen('cleared',ka._markNotificationsSeen);ka._jewelClickLogListener=ka._notificationsJewel.listen('jewel_click',ka._logNotificationJewelClick);ea.listen('m:jewel:flyout:open',null,ka._onJewelOpen);},openMessageJewel:function la(){ka._messagesJewel.openPopover();},setMessengerCliff:function la(ma,na,oa){ka._messengerCliff=ma;},setMessengerCliffShouldLog:function la(ma,na){},markFriendRequestsSeen:function la(event){if(ka._requestsJewel===null)return;ka._requestsJewel.setCount(0);},updateFriendRequests:function la(event){if(ka._requestsJewel===null)return;if(ka._requestsJewel.isOpen())return;var ma=new x('/ajax/mobile/friends/jewel/requests_markup');ma.send();},onAfterUpdateFriendRequests:function la(ma){if(ka._requestsJewel===null)return;ka._setJewelCount(ka._requestsJewel,ma,ka._markRequestsRead);ca.getInstance('reqs_flyout').refreshConstraints();if(ka._requestsJewel.isOpen()){var na=ka._requestsJewel._getContentsElement();ka._logPymkAndRequestImpression(na);}},onCombinedTabAsyncLoad:function la(){if(ka._notificationsJewel&&ka._notificationsJewel.isOpen()){var ma=ka._notificationsJewel._getContentsElement();ka._logPymkAndRequestImpression(ma);}},_logPymkAndRequestImpression:function la(ma){if(ka._pymkAndRequestImpressionLogged)return;ka._pymkAndRequestImpressionLogged=true;var na=m.scry(ma,'div','undoable-action');for(var oa=0;oa<na.length;oa++){var pa=na[oa].getAttribute('data-pymk-id');if(pa){var qa=na[oa].getAttribute('data-signature');w.logImpression(pa,qa,'mobile_jewel');}else{var ra=l.get(na[oa]).userid;q.log('request_seen','friend_request_waterfall',{request_id:ra,request_location:'requests_jewel'});p.logImpression(ra?ra.toString():null);}}},refreshNotificationsConstraints:function la(){ca.getInstance('notifications_flyout').refreshConstraints();},refreshNotificationsConstraintsOnImageLoad:function la(){var ma=document.getElementById('notifications_flyout');if(!ma)return;ka.refreshNotificationsConstraints();var na=ja(ka.refreshNotificationsConstraints,500);m.scry(ma,'img','notif_thumb').forEach(function(oa){var pa=n.listen(oa,'load',function(){pa.remove();na();});});},refreshMessagesConstraints:function la(){ca.getInstance('messages_flyout').refreshConstraints();},updateNotification:function la(event){var ma=event.getData();if(ma&&ma.data){if(ma.data.type==='friend_confirmed')return;if(!ka._notificationsJewel.isOpen()&&!ka._unseenNotificationIds[ma.data.alert_id])ka._notificationsJewel.setCount(ma.data.unread+ka._notificationsJewel.getCount());ka._notificationsJewel.removeMenuContent(ka._getNotifNodeID(ma.data.alert_id));ka._unseenNotificationIds[ma.data.alert_id]=true;if(ka._notificationsJewel.isOpen())ka._markNotificationsSeen();ka._loadNotificationJewelContent();}},updateUnseenNotificationIds:function la(event){var ma=event.getData();if(!ma)return;var na=event.getType()=='notifications_read';if(ma.alert_ids){var oa=0;for(var pa=0;pa<ma.alert_ids.length;pa++)if(ka._unseenNotificationIds[ma.alert_ids[pa]]){delete ka._unseenNotificationIds[ma.alert_ids[pa]];na&&ka._notificationsJewel.updateMenuColor(ka._getNotifNodeID(ma.alert_ids[pa]),true,false);oa++;}var qa=ka._notificationsJewel.getCount();ka._notificationsJewel.setCount(qa-oa);}else{ka._notificationsJewel.setCount(0);if(na)for(var ra in ka._unseenNotificationIds)ka._notificationsJewel.updateMenuColor(ka._getNotifNodeID(ra),true,false);ka._unseenNotificationIds={};}},updateUnreadMessageCount:function la(event){var ma=event.getData();if(!ma)return;if(ma.unseen!==null&&!ka._messagesJewel.isOpen())ka._messagesJewel.setCount(ma.unseen+ka._diodeBadgeableQPCount);if(ma.unread!==null){var na=null;if(ma.unread>0){na=ia._("Messages ({unread_message_count})",[ia.param('unread_message_count',ma.unread)]);}else na=ia._("Messages");ka._messagesJewel.setHeaderText('messages_jewel_header_text',na);}},updateMessage:function la(event){var ma=event.getData();if(!ma)return;if(ma.parsedPayload){var na=ma.parsedPayload;if(na.getFolder()!=='inbox'||!ka._viewerIsAParticipant(ka._viewerID,na))return;if(ka._messagesJewel.isInitialized()){ka._messagesJewel.removeMenuContent(ka._getMessageNodeID(na.getOtherUserFBID(),na.getThreadFBID()));if(ka._messagesJewel.isOpen())ka._markMessagesRead();}ka._loadMessagesJewelContent();}else if(ma.mark_as_read){for(var oa=0;oa<ma.other_user_fbids.length;oa++){var pa=ma.other_user_fbids[oa];if(ma.folder_info[pa]!=='inbox')continue;ka._messagesJewel.updateMenuColor(ka._getMessageNodeID(pa.toString(),null),ma.event=='read',false);}for(oa=0;oa<ma.thread_fbids.length;oa++){var qa=ma.thread_fbids[oa];if(ma.folder_info[qa]!=='inbox')continue;ka._messagesJewel.updateMenuColor(ka._getMessageNodeID(null,qa.toString()),ma.event=='read',false);}}else if(ma.event===r.READ&&ma.is_sync)ka._messagesJewel.updateMenuColor(ka._getMessageNodeID(ma.message.other_user_fbid,ma.message.thread_fbid),true,false);},_getMessageNodeID:function la(ma,na){ma=ma?ma:'';na=na?na:'';return ka.MSG_ID_PREFIX+ka.OTHER_USER_FBID_PREFIX+ma+ka.THREAD_FBID_PREFIX+na;},_getNotifNodeID:function la(ma){return ka.NOTIF_ID_PREFIX+ma;},_markRequestsRead:function la(){ea.invoke('m_requests_jewel_mark_read');var ma=new x(new aa('/a/jewel_requests_read.php').toString());ma.send();},_markMessagesRead:function la(){var ma=new x(new aa('/a/jewel_messages_read.php').toString());ma.send();},_markNotificationsSeen:function la(){if(ka._jewelClickLogListener){ka._jewelClickLogListener.remove();ka._jewelClickLogListener=null;}if(ka._hasCombinedTab)ka._markRequestsRead();var ma=ka._unseenNotificationIds;ka._unseenNotificationIds={};var na=[];for(var oa in ma)na.push(oa);var pa=new x(new aa('/a/jewel_notifications_read.php').toString());pa.addData({ids:na,count:na.length,seen:true});pa.send();},_onJewelOpen:function la(event){var ma=event.getData();if(ma&&ma.jewel)if(ma.jewel==='notifications'){ka._loadNotificationJewelContent();}else if(ma.jewel==='messages'){if(ka._messengerCliff)new fa().setSurface('messenger_seen').log();var na=ka._messagesJewel.getCount()-ka._diodeBadgeableQPCount;ka._messagesJewel.setCount(na);ka._diodeBadgeableQPCount=0;ka._loadMessagesJewelContent();}da.set('topbar_'+ma.jewel);},_loadNotificationJewelContent:function la(){var ma=ka._notificationsJewel._getContentsElement(),na='notifications-flyout-loading';if(ea.hasSigil(ma,na)){var oa=ha.getURIBuilder().setString('spinner_id',ma.getAttribute('id')).getURI();if(!ka._lazyLoadNotificationsReq){ka._lazyLoadNotificationsReq=new x(oa);ka._lazyLoadNotificationsReq.listen('finally',function(){ka._lazyLoadNotificationsReq=null;});ka._lazyLoadNotificationsReq.send();}}},_loadMessagesJewelContent:function la(){var ma=ka._messagesJewel._getJewelElement(),na='messages-flyout-loading',oa=m.scry(ma,'*',na);if(oa.length>0){var pa=ga.getURIBuilder().setString('spinner_id',oa[0].getAttribute('id')).getURI();if(!ka._lazyLoadMessagesReq){ka._lazyLoadMessagesReq=new x(pa);ka._lazyLoadMessagesReq.listen('finally',function(){ka._lazyLoadMessagesReq=null;});ka._lazyLoadMessagesReq.send();}}},_logNotificationJewelClick:function la(){if(ka._jewelClickLogListener){ka._jewelClickLogListener.remove();ka._jewelClickLogListener=null;}if(ka._hasCombinedTab){var ma=ka._notificationsJewel._getContentsElement();ka._logRequestsImpessions(ma);if(ka._notificationsJewel.isOpen())if(!ea.hasSigil(ma,'notifications-flyout-loading'))ka._logPymkAndRequestImpression(ma);}new x('/a/jewel_notifications_log.php').addData({click_type:'jewel_click',count:ka._notificationsJewel.getCount()}).send();},_logRequestsJewelClick:function la(){var ma=ka._requestsJewel._getContentsElement();ka._logRequestsImpessions(ma);new o().setSurface('jewel').setBadgeCount(ka._requestsJewel.getCount()).log();if(ka._requestsJewel.isOpen())if(ea.hasSigil(ma,'requests-flyout-loading')){new x('/ajax/mobile/friends/jewel/requests_markup').send();}else{var na=ka._requestsJewel._getContentsElement();ka._logPymkAndRequestImpression(na);}},_logRequestsImpessions:function la(ma){if(!ma)return;var na=m.scry(ma,'div','attachment'),oa=[];for(var pa=0;pa<na.length;pa++){var qa=na[pa].getAttribute('id');if(qa&&qa.startsWith('m_jewel_req_'))oa=oa.concat(qa.replace('m_jewel_req_',''));}if(oa.length){var ra=new x('/friends/requests/log_impressions');ra.setMethod('POST');ra.addData({ids:oa.join(','),ref:'m_jewel'});ra.send();}},_viewerIsAParticipant:function la(ma,na){if(!na.getParticipantIDs())return false;if(na.getParticipantIDs().indexOf(ma)>-1)return true;return na.getParticipantIDs().indexOf(ma.toString())>-1;},_initJewelCount:function la(ma,na,oa){ma.setDuringInit(true);ma.reregisterListeners();ka._setJewelCount(ma,na,oa);ma.setDuringInit(false);},_setJewelCount:function la(ma,na,oa){if(!ma.isOpen()){ma.setCount(na);}else if(na)oa();},_initJewelCounts:function la(event){var ma=event.getData();ka.initJewels(null,null);if(ma.viewer_id)ka._viewerID=ma.viewer_id;if(ma.unread_notification_ids)ka._unseenNotificationIds=ma.unread_notification_ids||{};if(ma.request_count&&ka._requestsJewel)ka._initJewelCount(ka._requestsJewel,ma.request_count,ka._markRequestsRead);if(ma.message_count||ma.diode_badgeable_qp_count){var na=(ma.message_count?ma.message_count:0)+(ma.diode_badgeable_qp_count?ma.diode_badgeable_qp_count:0);if(ma.diode_badgeable_qp_count)ka._diodeBadgeableQPCount=ma.diode_badgeable_qp_count;ka._initJewelCount(ka._messagesJewel,na,ka._markMessagesRead);}if(ma.notification_count)ka._initJewelCount(ka._notificationsJewel,ma.notification_count,ka._markNotificationsSeen);},initJewels:function la(ma,na){if(ka._haveInitializedJewels)return;ka._haveInitializedJewels=true;y.initialize();ka.createJewels(na||{});if(ka._requestsJewel){if(!ka._friendRequestAddListener)ka._friendRequestAddListener=ea.listen('jewel_requests_add',null,ka.updateFriendRequests);if(!ka._friendRequestRemoveListener)ka._friendRequestRemoveListener=ea.listen('jewel_requests_remove_old',null,ka.updateFriendRequests);if(!ka._friendAcceptedListener)ka._friendAcceptedListener=ea.listen('jewel_friending_notifs',null,ka.updateFriendRequests);if(!ka._friendRequestSeenListener)ka._friendRequestSeenListener=ea.listen('friend_requests_seen',null,ka.markFriendRequestsSeen);}if(!ka._notificationListener)ka._notificationListener=ea.listen('m_notification',null,ka.updateNotification);if(!ka._notificationRefreshListener)ka._notificationRefreshListener=ea.listen('m:jewel-set:notifications-jewel:refresh-flyout',null,ka.refreshNotificationsConstraints);if(!ka._messageListener)ka._messageListener=ea.listen(j.MESSAGE,null,ka.updateMessage);if(!ka._messageCountListener)ka._messageCountListener=ea.listen('inbox',null,ka.updateUnreadMessageCount);if(!ka._notifReadListener)ka._notifReadListener=ea.listen('notifications_read',null,ka.updateUnseenNotificationIds);if(!ka._notifSeenListener)ka._notifSeenListener=ea.listen('notifications_seen',null,ka.updateUnseenNotificationIds);if(!ka._friendRequestResponseListener)ka._friendRequestResponseListener=ea.listen('m:requests:refresh',null,function(){var oa=ka._hasCombinedTab?'notifications_flyout':'reqs_flyout';ca.getInstance(oa).refreshConstraints();});if(!ka._orientationChangeListener)ka._orientationChangeListener=ea.listen('m:viewport:orientation-change',null,ka._onOrientationChange);this._initMTouchDisplayNoneTest();},_initMTouchDisplayNoneTest:function la(){if(z&&z.gk_check)k.addClass(document.body,'MTouchDisplayNoneTestGK');},_onOrientationChange:function la(){setTimeout(function(){var ma=ca._activePopover;if(!ma)return;if(ba.getHeight()+'px'!==ma.flyout.style.minHeight)ma.refreshConstraints();},800);}};(function(){ea.listen('m:jewels:init-counts',null,ka._initJewelCounts);s.replayMissedEvents();})();f.exports=ka;}),null);
__d('MSearchOverlay',['setTimeoutAcrossTransitions','$','CSS','DOM','MLegacyDataStore','MSearchConst','MSearchTrendingLogger','MViewport','MLinkHack','Stratcom','URI','Vector'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=function u(v){var w=i(v.overlay),x=k.find(w,'div','typeahead-hardpoint'),y=i(v.textinput),z=v.nullstate,aa=v.emptyStatePromo;if(y.tagName!=='input')y=k.find(y,'input');var ba=l.get(x);if(ba.typeahead){ca();}else q.listen('m:search-typeahead:ready',null,ca);function ca(){var da=ba.typeahead;q.listen('m:text-input:clear',null,ma);var ea,fa=true;function ga(){return Math.max(s.getDim(w).y+o.getHeaderHeight(),o.getScreenHeight());}function ha(){if(!aa)return;j.conditionShow(aa,da.getValue().length===0);}function ia(pa){ea=o.addHeightConstraint(ga());j.conditionClass(i("page"),'sideSearchShowing',true);o.scrollToHeader();ha();if(z&&da.getValue().length===0)ja(z);}function ja(pa){var qa=pa.getElementsByClassName('jx-typeahead-results')[0].getAttribute('data-query'),ra=[],sa=[],ta=pa.getElementsByClassName('jx-result');for(var ua=0;ua<ta.length;ua++){ra.push(ta[ua].getAttribute('data-topic'));sa.push(ua+1);}n.registerTrendingTopicListeners(ra,m.msite_news_non_gs_null_state,sa,qa);n.logTrendingTopicImpressions(ra,m.msite_news_non_gs_null_state,sa,qa);}function ka(pa){j.conditionClass(i("page"),'sideSearchShowing',false);ea&&ea.release();ea=null;}function la(pa){q.invoke('log-m-search-session-end',null,{reason:pa});}function ma(){da.clear();da.refresh();}function na(){fa=false;ma();oa();ha();}function oa(){y.blur();}q.listen('m:chrome:tab:show','search',function(pa){ia();y.focus();});q.listen('m:chrome:tab:hide','search',function(pa){la('cancel');na();ka();});da.listen('show',function(){h(function(){ea&&ea.setValue(ga());},0);if(z)if(da.getValue().length>0){k.hide(z);}else k.show(z);ha();});k.listen(x,'click','typeahead-result',function(pa){var qa=q.invoke('m:search-typehead:click',null,pa.getNode('typeahead-result')),ra=qa.getData();p.safe(ra,function(sa){sa.href=new r(sa.href).addQueryData('refid',m.refid);});qa.setData(ra);if(qa.getPrevented()){if(qa.getStopped()){pa.kill();}else pa.prevent();oa();}else{setTimeout(function(){na();},0);ka();}});da.listen('refresh-viewport',function(){q.context().prevent();});da.listen('choose',function(){q.context().prevent();});w.onclick=function(){y.focus();};k.listen(w,'touchstart','jx-result',oa);k.listen(y,'focus',null,function(pa){fa=true;o.scrollToHeader();});da.listen('blur',function(pa){if(fa)pa.prevent();});q.listen('m:side-area:hide',null,function(){la('back');ka();});}};g.main=t;}),null);
__d("XBookmarksFlyoutBodyController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/bookmarks\/flyout\/body\/",{id:{type:"String",required:true}});}),null);
__d('MChromeTabsBootloader',['MJewels','MRequest','Stratcom','XBookmarksFlyoutBodyController'],(function a(b,c,d,e,f,g,h,i,j,k){var l={bootloadBookmarks:function m(n){j.listen('m:chrome:tab:show',h.BOOKMARKS,function(){j.removeCurrentListener();new i(k.getURIBuilder().setString('id',n).getURI()).send();});}};f.exports=l;}),null);
__d('MJewelNotifications',['Bootloader','ChannelEventType','MRequest','MURI','Run','Stratcom','SubscriptionsHandler','isFacebookURI'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';var p={overlayIcon:false};function q(r,s){this.$MJewelNotifications1=r;this.$MJewelNotifications2=[];this.$MJewelNotifications3=false;this.$MJewelNotifications4=false;this.$MJewelNotifications5=s||p;this.$MJewelNotifications6=new n();this.$MJewelNotifications6.addSubscriptions(l.onLeave(function(){this.$MJewelNotifications6.release();}.bind(this)),m.listen(i.NOTIFICATIONS_NEW,null,this.onNotificationReceive.bind(this)));}q.prototype.getNotifications=function(){return this.$MJewelNotifications2;};q.prototype.registerListeners=function(){this.$MJewelNotifications6.addSubscriptions(m.listen(i.NOTIFICATIONS_READ,null,this.onNotificationRead.bind(this)),m.listen('click','live-notifications',this.onNotificationClick.bind(this)),m.listen('m:jewel:flyout:open',null,this.onJewelOpen.bind(this)));};q.prototype.onJewelOpen=function(event){var r=event.getData(),s=r&&r.jewel&&r.jewel==='notifications';if(s&&this.$MJewelNotifications4)this.updateUI();};q.prototype.onNotificationClick=function(event){var r=event.getNode('live-notification');if(!r)return;var s=r.getAttribute('data-alertid');this.readNotification(s);this.updateUI();new j('/a/jewel_notifications_log.php').addData({click_type:'jewel_notif_click',id:s}).send();};q.prototype.onNotificationRead=function(event){var r=event.getData();if(r&&r.alert_ids){r.alert_ids.forEach(function(s){this.readNotification(s);}.bind(this));this.updateUI();}};q.prototype.readNotification=function(r){this.$MJewelNotifications2.forEach(function(s){if(s.alert_id==r){if(s.unread)this.$MJewelNotifications4=true;s.unread=false;}}.bind(this));};q.prototype.addNotification=function(r){this.$MJewelNotifications2=this.$MJewelNotifications2.filter(function(s){return s.alert_id!==r.alert_id;});r.timestamp=Date.now();this.$MJewelNotifications2.push(r);this.$MJewelNotifications4=true;};q.prototype.onNotificationReceive=function(event){var r=event.getData();if(r&&r.data){if(r.data.type==='friend_confirmed')return;if(!this.$MJewelNotifications3){this.$MJewelNotifications3=true;this.registerListeners();}this.addNotification(r.data);this.updateUI();}};q.prototype.updateUI=function(){if(!this.$MJewelNotifications3||!this.$MJewelNotifications4)return;h.loadModules(["React","ReactDOM","MJewelNotificationList.react","Popover"],function(r,s,t,u){if(!u.getInstance('notifications_flyout').isOpen())return;var v={notifications:this.$MJewelNotifications2,overlayIcon:this.$MJewelNotifications5.overlayIcon};s.render(r.createElement(t,v),this.$MJewelNotifications1);u.getInstance('notifications_flyout').refreshConstraints();this.$MJewelNotifications4=false;}.bind(this),'MJewelNotifications');};f.exports=q;}),null);
__d('MJewelThreads',['Bootloader','ChannelEventType','MessagingEvent','Stratcom'],(function a(b,c,d,e,f,g,h,i,j,k){'use strict';function l(m){this.$MJewelThreads1=m;this.$MJewelThreads2=[];this.$MJewelThreads3=false;this.$MJewelThreads4=false;k.listen(i.MESSAGE,null,this.onMessageEvent.bind(this));}l.prototype.getThreads=function(){return this.$MJewelThreads2;};l.prototype.registerListeners=function(){k.listen('click','live-threads',this.onThreadClick.bind(this));k.listen('m:jewel:flyout:open',null,this.onJewelOpen.bind(this));};l.prototype.onJewelOpen=function(event){var m=event.getData(),n=m&&m.jewel&&m.jewel==='messages';if(n&&this.$MJewelThreads4)this.updateUI();};l.prototype.onThreadClick=function(event){var m=event.getNode('live-thread');if(!m)return;this.setThreadReadStatus(m.getAttribute('data-fbid'),m.getAttribute('data-canonical')==='true',true);this.updateUI();};l.prototype.onMessageEvent=function(event){var m=event.getData();if(m.parsedPayload){var n=m.parsedPayload;if(n.getFolder()!=='inbox')return;if(!this.$MJewelThreads3){this.$MJewelThreads3=true;this.registerListeners();}this.addThread(n);}else if(Object.prototype.hasOwnProperty.call(m,'mark_as_read')){m.other_user_fbids.forEach(function(q){this.setThreadReadStatus(q.toString(),true,m.mark_as_read);}.bind(this));m.thread_fbids.forEach(function(q){this.setThreadReadStatus(q.toString(),false,m.mark_as_read);}.bind(this));this.updateUI();}else if(m.event===j.READ&&m.is_sync){var o=!!m.message.other_user_fbid,p=o?m.message.other_user_fbid:m.message.thread_fbid;this.setThreadReadStatus(p,o,true);this.updateUI();}};l.prototype.addThread=function(m){this.$MJewelThreads2=this.$MJewelThreads2.filter(function(n){var o=n.isCanonicalThread()?n.getOtherUserFBID():n.getThreadFBID();return !this.isSameThread(o,m.isCanonicalThread(),m);}.bind(this));m.unread=m.isUnread();this.$MJewelThreads2.push(m);this.$MJewelThreads4=true;this.updateThreadImage(m);};l.prototype.updateThreadImage=function(m){h.loadModules(["MMessagesThreadMetadataCache","MShortProfiles"],function(n,o){if(m.hasThreadImage()){n.get(m.getThreadFBID(),function(q){m.image_src=q.image_src;this.updateUI();}.bind(this));}else{var p=m.isCanonicalThread()?m.getOtherUserFBID():m.getAuthorFBID();o.get(p,function(q){m.image_src=q.mThumbSrcSmall;this.updateUI();}.bind(this));}}.bind(this),'MJewelThreads');};l.prototype.setThreadReadStatus=function(m,n,o){this.$MJewelThreads2.forEach(function(p){if(this.isSameThread(m,n,p)){if(p.unread==o)this.$MJewelThreads4=true;p.unread=!o;}}.bind(this));};l.prototype.isSameThread=function(m,n,o){var p=n?o.getOtherUserFBID():o.getThreadFBID();return m==p;};l.prototype.updateUI=function(){if(!this.$MJewelThreads3||!this.$MJewelThreads4)return;h.loadModules(["React","ReactDOM","MJewelThreadList.react","Popover"],function(m,n,o,p){if(!p.getInstance('messages_flyout').isOpen())return;var q={threads:this.$MJewelThreads2};n.render(m.createElement(o,q),this.$MJewelThreads1);p.getInstance('messages_flyout').refreshConstraints();this.$MJewelThreads4=false;}.bind(this),'MJewelThreads');};f.exports=l;}),null);
__d('MessagesJewelNativeAppRedirect',['Stratcom','URI','MRequest','XMSiteDiodeMessengerLoggingController','MSiteMessengerDiodeTypedLogger','MSiteMessengerDiodeLoggerEvent','MHistory','MJewels'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={registerOpenURIStringForIOS:function q(r,s){function t(event){if(event.getData().jewel==='messages'){var u=k.getURIBuilder().setBool('log',true).getURI(),v=new j(u);v.listen('done',function(w){if(s){var x=new i(r);x.go();}});v.listen('error',function(w){if(s){var x=new i(r);x.go();}});v.send();}}h.listen('m:jewel:flyout:open',null,t);},registerRedirect:function q(r,s,t,u,v){function w(event){if(event.getData().jewel==='messages'){var x=k.getURIBuilder().setBool('log',true).getURI();new j(x).send();if(t){new l().setEvent(m.FAST_APP_SWITCH_ATTEMPT).setMessagingEntryPoint(s).setMsiteDiodeStateFromClient(u).log();var y=new i(r);y.go();if(v)n.popSoftState(o.MESSAGES);}}}h.listen('m:jewel:flyout:open',null,w);}};f.exports=p;}),null);
__d('MRequestsJewelFriendConfirmedNotif',['CSS','cx','DOM','MRequest','MURI','Stratcom'],(function a(b,c,d,e,f,g,h,i,j,k,l,m){var n={_viewerID:null,_unseenNotifIDs:[],_notifMarkReadListener:null,_notifToggleListener:null,_slaves:null,_master:null,_slaveShown:false,_unread:false,_notifStatusSet:false,updateUnseenNotifIDs:function o(p,q,r){this._viewerID=q;this._unread=r;this._unseenNotifIDs=p;this._shown=false;this._notifStatusSet=false;if(this._notifMarkReadListener===null)this._notifMarkReadListener=m.listen('m_requests_jewel_mark_read',null,this.setNotifsRead.bind(this));if(this._notifToggleListener===null){if(this._master===null)this._master=j.scry(document.body,'div','m_requests_jewel_accept_notif_master')[0];if(this._slaves===null)this._slaves=j.scry(document.body,'div','m_requests_jewel_accept_notif_slave')[0];this._notifToggleListener=m.listen('click','m_requests_jewel_accept_notif_master',function(){if(this._unread){h.removeClass(this._master,"_uss");this._unread=false;}if(!this._notifStatusSet){this.setNotifsRead;this._notifStatusSet=true;}if(this._slaveShown&&this._slaves!==undefined){h.hide(this._slaves);this._slaveShown=false;}else{h.show(this._slaves);this._slaveShown=true;}}.bind(this));}},setNotifsRead:function o(){if(this._notifStatusSet||this._unseenNotifIDs.length===0)return;var p=new k(new l('/a/jewel_notifications_read.php').toString());p.addData({ids:this._unseenNotifIDs,count:this._unseenNotifIDs.length,seen:false});p.send();this._notifStatusSet=true;}};f.exports=n;}),null);
__d('MBeeperController',['Bootloader','CSS','DOM','MHistory','Stratcom','URI','cx','getActiveElement','setTimeoutAcrossTransitions','$'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=void 0,s=void 0,t=void 0,u=void 0,v=[],w=void 0,x=3000;function y(ga){w=ga;p(function(){l.listen('m_notification',null,z);l.listen('blur',null,aa);l.listen('m:history:change',null,fa);},x);}function z(ga){var ha=ga.getData();if(!ha||!ha.data||w&&!ha.data.type||w&&w.indexOf(ha.data.type)===-1)return;var ia={notification:ha.data};ea(ia);if(!r&&!s){h.loadModules(["ReactComponentRenderer","MBeeper.react"],function(ja,ka){r=ja;s=ka;fa();},'MBeeperController');}else fa();}function aa(ga){var ha=ga.getTarget();if(ha&&ca(ha))setTimeout(fa,50);}function ba(){v.shift();fa();}function ca(ga){var ha=ga.tagName;return ha==='INPUT'||ha==='TEXTAREA'||ga.contentEditable==='true';}function da(){return !(ca(o())||q('root').offsetHeight===0);}function ea(ga){var ha=v.find(function(ia){return ia.notification.alert_id===ga.notification.alert_id;});if(!ha)v.push(ga);}function fa(){if(!da())return;var ga=new m(k.getPath());if(ga.getQueryData().soft==='notifications'){v=[];return;}var ha=v[0];if(!ha)return;if(!t){t=j.create('div');i.addClass(t,"_3hy8");q('page').appendChild(t);}if(!u){if(r){u=new r(s,t);u.setProps(babelHelpers['extends']({},ha,{onHide:ba}));}}else if(u.component.isReady())u.setProps(ha);}g.init=y;}),null);
__d('MNotificationClick',['CSS','MLegacyDataStore','Stratcom','MRequest'],(function a(b,c,d,e,f,g,h,i,j,k){var l='notification',m='list_',n='acw',o='aclb',p={},q=false;f.exports={init:function v(){if(q)return;j.listen('click',l,r);j.listen('m:page:render:cache:complete',null,s);q=true;}};function r(event){var v=event.getNode('touchable');if(!v)return;var w=i.get(v).notif_id;if(!w)return;new k('/a/jewel_notifications_log.php').addData({click_type:'notification_click',id:w,target_id:i.get(v).target_id}).send();t(event);}function s(v){if(v.getData().path.indexOf('notifications')>-1)for(var w in p)u(w);}function t(event){var v=event.getNode('marea');if(!v)return;var w=v.getAttribute('id');if(!w)return;u(w);var x=w.startsWith(m)?w.substring(m.length):m+w;u(x);p[w]=true;p[x]=true;}function u(v){var w=document.getElementById(v);if(w){h.addClass(w,n);h.removeClass(w,o);}}}),null);
__d('MFirstPageRecorder',['DOM','MDeepCopy','MURI','MPageCache','MPageController','MPageHeaderRight','MPageTitle','MPageletTypes','MRenderingScheduler','MRequestConfig','MResponseData','Stratcom','ScriptPath','$','ge','ServerJS'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w,x=true,y=[];function z(){if(w)return;w=true;var aa=new j(l.getRenderedPath()),ba,ca=[];y=[p.getInstance().attachListenerToSyncPageletComplete(function(){k.setCachedPage(aa,ba);k.clearCachedIUIResponses(aa);ca.forEach(function(da){k.addCachedIUIResponse(aa,da);});}),p.getInstance().attachListenerToSyncPageletLoader(function(da){if(da.pageletConfig.type!==o.CONTENT)return;var ea={ajax_response_token:q.ajaxResponseToken.secret,js:da.js||[],css:da.css||[],ixData:da.ixData};ea.actions=[{cmd:'replace',target:da.id,html:da.element?v(da.element).innerHTML:da.content.__html,replaceifexists:false,allownull:false},{cmd:'append',target:'static_templates',html:da.pageletConfig.templates.__html,replaceifexists:true}];var fa=i(da.pageletConfig.serverJSData),ga=[function(){var ma=c('ServerJS');new ma().handle(i(fa));}];if(x){x=false;var ha=u('root').cloneNode(true);ba=new r({ajax_response_token:q.ajaxResponseToken.secret,js:[],css:[],ixData:[],actions:[{cmd:'script',type:'immediate',fn:function ma(){h.replace(u('root'),ha.cloneNode(true));}}]});var ia=m.getChromeHeaderRightContent();if(ia&&ia.length>0)ga.push(function(){var ma=document.createDocumentFragment();for(var na=0;na<ia.length;na++)ma.appendChild(ia[0]);m.setup({node:ma});});var ja=document.title;ga.push(function(){n.setTitle(ja);});var ka=t.getPageInfo();if(ka)ga.push(function(){t.set(ka.scriptPath,ka.categoryToken,ka.extraData);});}for(var la=0;la<ga.length;la++)ea.actions.push({cmd:'script',type:'onload',fn:ga[la]});ca.push(new r(ea));})];}s.listen('m:page:unload',null,function(){y.forEach(function(aa){aa&&aa.remove();aa=null;});w=true;s.removeCurrentListener();});g.startPageletCaching=z;}),null);
__d('MQuickPromotion',['DOM','Stratcom'],(function a(b,c,d,e,f,g,h,i){var j=false,k=function l(){if(j)return;j=true;var m='m-promo-close';function n(event){var o=event.getNode('m-promo');h.hide(o);}i.listen('click',m,n);};g.main=k;}),null);
__d('MOpenable',['CSS','Stratcom'],(function a(b,c,d,e,f,g,h,i){var j='openable',k='opened',l;function m(o){l=o;h.conditionClass(l,k,true);}function n(){if(l){h.conditionClass(l,k,false);l=null;}}i.listen('touchstart',null,function(event){if(event.getNode(j)!=l)n();});i.listen('click',null,function(event){var o=event.getNode(j),p=l;n();if(o&&o!=p)m(o);});i.listen('touchcancel',null,n);g.main=function(){};}),null);
__d('MSearchTypeaheadSeeMore',['DOM','MSearchTypeaheadSeeMoreExperiments','cx','fbt'],(function a(b,c,d,e,f,g,h,i,j,k){var l=20;function m(){'use strict';this.$MSearchTypeaheadSeeMore1=this.$MSearchTypeaheadSeeMore2();this.$MSearchTypeaheadSeeMore3=h.create('a',{className:"touchable viewMore _2u_r",sigil:'touchable typeahead-result'},[this.$MSearchTypeaheadSeeMore4(),this.$MSearchTypeaheadSeeMore1]);this.$MSearchTypeaheadSeeMore3.isSeeMore=true;}m.prototype.$MSearchTypeaheadSeeMore4=function(){'use strict';return h.create('div',{className:"_2u_s"},h.create('i',{className:"_2u_t"}));};m.prototype.$MSearchTypeaheadSeeMore2=function(){'use strict';return h.create('div',{className:"_2u_u"});};m.prototype.show=function(){'use strict';h.show(this.$MSearchTypeaheadSeeMore3);return this;};m.prototype.hide=function(){'use strict';h.hide(this.$MSearchTypeaheadSeeMore3);return this;};m.prototype.setQuery=function(n){'use strict';this.$MSearchTypeaheadSeeMore3.href='/search/top/?q='+encodeURIComponent(n);h.setContent(this.$MSearchTypeaheadSeeMore1,this.$MSearchTypeaheadSeeMore5(this.$MSearchTypeaheadSeeMore6(n)));return this;};m.prototype.injectInto=function(n){'use strict';var o=i.placement;if(o==='last'){o=n.length;}else o=Number(o);n.splice(o,0,this.$MSearchTypeaheadSeeMore3);return this;};m.prototype.$MSearchTypeaheadSeeMore5=function(n){'use strict';if(i.verbose)return k._(["See more results for {query}","44e6d113d67af68d7209174cf9420c3d"],[k.param('query',n)]);return n;};m.prototype.$MSearchTypeaheadSeeMore6=function(n){'use strict';if(n.length>l)return n.substr(0,l-3)+'...';return n;};f.exports=m;}),null);
__d('MSearchTypeahead',['DOM','CSS','MPageController','MPlaces','MRequest','MSearchTypeaheadSeeMore','SearchMTouchGlobalOptions','MURI','Stratcom','Typeahead','createDeprecatedProperties','cx','eventsMixinDeprecated','fbt'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v,w;v=babelHelpers.inherits(x,q);w=v&&v.prototype;function x(y,z,aa){'use strict';var ba=h.find(y,'div','searchLoadingIndicator');h.hide(ba);w.constructor.call(this,y,z);this.loadingIndicator=ba;this.recentHeader=h.scry(y,'div','recentSearchesHeader')[0];this.hideRecentHeader();this.PYMKHeader=h.scry(y,'div','PYMKHeader')[0];this.hidePYMKHeader();this._typeaheadSessionID=null;this._seeMore=new m().hide();this.uberbarQRPromo=h.scry(document.body,'*','uberbarQRPromo')[0];if(n.noSnippet)i.addClass(this._root,'nosnippet');h.listen(this._root,'click','tag:a',function(ca){var da=ca.getNode('tag:a');this.invoke('select',da);this.invoke('result-selected',da);}.bind(this));h.listen(this._control,'focus',null,this.onFocus.bind(this));p.listen('m-typeahead-logger:new-session-id',null,function(ca){if(!this._typeaheadSessionID)this._typeaheadSessionID=ca.__auto__data.sessionID;}.bind(this));h.listen(this._control,'blur',null,this.stopWatchLocation);}x.prototype.hide=function(){'use strict';if(this.getPermanent())return;q.prototype.hide.call(this);};x.prototype.setDatasource=function(y){'use strict';q.prototype.setDatasource.call(this,y);y.listen('complete',this.complete.bind(this));this.listen('show',this.resultsShown.bind(this));};x.prototype.submit=function(){'use strict';if(this.getValue()!==''){q.prototype.submit.call(this);if(n.enableSeeMore){var y=new o('/search/').setQueryData({query:this.getValue(),tsid:this._typeaheadSessionID}).toString();this.invoke('on-enter-pressed',y.toString());j.forceLoad(y);}this._control.blur();}};x.prototype.waitForResults=function(){'use strict';if(window.FW_ENABLED){this._root.appendChild(this.loadingIndicator);}else this._root.insertBefore(this.loadingIndicator,this._root.lastChild);h.show(this.loadingIndicator);};x.prototype.complete=function(){'use strict';if(window.FW_ENABLED&&this._display.length===0)this._root.appendChild(h.create('div',{className:'noResults'},u._("No results")));if(window.FW_ENABLED&&this.uberbarQRPromo){this._root.appendChild(this.uberbarQRPromo);h.show(this.uberbarQRPromo);}h.hide(this.loadingIndicator);};x.prototype.hideRecentHeader=function(){'use strict';this.recentHeader&&h.hide(this.recentHeader);};x.prototype.showRecentHeader=function(){'use strict';this.recentHeader&&h.show(this.recentHeader);};x.prototype.hidePYMKHeader=function(){'use strict';this.PYMKHeader&&h.hide(this.PYMKHeader);};x.prototype.showPYMKHeader=function(){'use strict';this.PYMKHeader&&h.show(this.PYMKHeader);};x.prototype.resultsShown=function(y){'use strict';var z=y.show;if(this.getValue().length!==0){this.hideRecentHeader();this.hidePYMKHeader();if(!window.FW_ENABLED)if(n.enableSeeMore)this._seeMore.setQuery(this.getValue()).injectInto(z).show();z.push(this.loadingIndicator);h.show(this.loadingIndicator);}else{var aa=this.adjustHeaders(z);if(aa>0)i.addClass(z[aa-1],"jx-result-no-border");}if(this.showPresence)this.showPresenceIcons(z);return true;};x.prototype.adjustHeaders=function(y){'use strict';var z=-1;for(var aa=0;aa<y.length;aa++){var ba=h.find(y[aa],'a'),ca=JSON.parse(ba.getAttribute('data-extra'));if(ca.isPYMK){z=aa;break;}}if(z>-1){y.splice(z,0,this.PYMKHeader);this.showPYMKHeader();}else this.hidePYMKHeader();if(z===0){this.hideRecentHeader();}else this.showRecentHeader();if(this.PYMKHeader)i.conditionClass(this.PYMKHeader,"mSearchTypeaheadHeaderWithBorder",z>0);return z;};x.prototype.showPresenceIcons=function(y){'use strict';var z=[];for(var aa=0;aa<y.length;++aa)if(y[aa].rel)z.push(y[aa].rel);var ba=new l(new o('/chat/presence_icon.php').toString());ba.setData({ids:z});ba.listen('done',function(ca){if(!ca||ca.length===0)return;var da=h.scry(this._root,'a','typeahead-result');for(var ea=0;ea<da.length;++ea)if(ca[da[ea].rel]===1){var fa=h.find(da[ea],'i','presence');h.show(fa);}}.bind(this));ba.send();};x.prototype.addLocationAwareSource=function(y){'use strict';p.listen('location-update',null,function(event){y.setAuxiliaryData(Object.assign(y.getAuxiliaryData()||{},{json_location:k.getCurrentJSONLocation()}));});};x.prototype.onFocus=function(){'use strict';this.refresh();this.startWatchLocation();};x.prototype.startWatchLocation=function(){'use strict';if(k.shouldUseFWGeolocation())k.monitorLocation();};x.prototype.stopWatchLocation=function(event){'use strict';k.clearWatch();};r(x,{permanent:false});t(x,['select','result-selected','on-enter-pressed']);Object.assign(x.prototype,{icons:null,loadingIndicator:null,uberbarQRPromo:null,showPresence:false});f.exports=x;}),null);
__d('MTypeaheadNativeSource',['MTypeaheadHelpers','Stratcom','TypeaheadInternationalNormalizer','TypeaheadPreloadedSource','createDeprecatedProperties','eventsMixinDeprecated','FWLoader'],(function a(b,c,d,e,f,g,h,i,j,k,l,m){var n,o,p=c('FWLoader').FW;n=babelHelpers.inherits(q,k);o=n&&n.prototype;function q(r){'use strict';o.constructor.call(this,r);this.setNormalizer(j.normalize);}q.prototype.didStart=function(){'use strict';var r=this;i.listen('fw-bootstrapped-results-ready',null,function(s){r.invoke('rawresultsready',s.getData().friends);r.ondata(s.getData().friends);});window.FW_ENABLED&&p.bootstrapUsers();};q.prototype.ondata=function(r){'use strict';for(var s=0;s<r.length;++s)r[s].idx=s;k.prototype.ondata.apply(this,arguments);};q.prototype.sortHits=function(r,s){'use strict';var t=function(u,v){var w=this._raw[u],x=isNaN(w.idx)?Number.MAX_VALUE:w.idx,y=this._raw[v],z=isNaN(y.idx)?Number.MAX_VALUE:y.idx;return x-z;}.bind(this);s.sort(t);};q.prototype.matchResults=function(r){'use strict';var s=this.normalize(r);k.prototype.matchResults.call(this,s);};q.prototype.createNode=function(r){'use strict';return h.createNode(r,this.getShowSecondaryAction());};m(q,['rawresultsready']);l(q,{transformer:function r(s){return {name:s.text,uri:s.path,id:s.uid,photo:s.photo,display:s.display||s.text,action:s.action,paths:s.paths,permissions:s.permissions,bootstrap:s.bootstrap,nativethirdpartyappicon:s.nativethirdpartyappicon};},showSecondaryAction:true});f.exports=q;}),null);
__d('MTypeaheadPackagedSource',['MTypeaheadHelpers','TypeaheadInternationalNormalizer','TypeaheadPreloadedSource','createDeprecatedProperties'],(function a(b,c,d,e,f,g,h,i,j,k){var l,m;l=babelHelpers.inherits(n,j);m=l&&l.prototype;function n(o){'use strict';m.constructor.call(this);this.packagedResults=o;this.setNormalizer(i.normalize);}n.prototype.didStart=function(){'use strict';this.ondata(this.packagedResults);};n.prototype.ondata=function(o){'use strict';for(var p=0;p<o.length;++p)o[p].idx=p;j.prototype.ondata.apply(this,arguments);};n.prototype.sortHits=function(o,p){'use strict';var q=function(r,s){var t=this._raw[r],u=isNaN(t.idx)?Number.MAX_VALUE:t.idx,v=this._raw[s],w=isNaN(v.idx)?Number.MAX_VALUE:v.idx;return u-w;}.bind(this);p.sort(q);};n.prototype.matchResults=function(o){'use strict';var p=this.normalize(o);j.prototype.matchResults.call(this,p);};n.prototype.createNode=function(o){'use strict';return h.createNode(o,this.getShowSecondaryAction());};k(n,{transformer:function o(p){return {name:p.text,uri:p.path,id:p.uid,photo:p.photo,display:p.display||p.text,action:p.action,paths:p.paths,permissions:p.permissions,type:p.type,openinnewtab:p.openinnewtab,subtext:p.subtext,bootstrap:p.bootstrap,verified:p.verified,nativethirdpartyappicon:p.nativethirdpartyappicon};},packagedResults:null,showSecondaryAction:true});f.exports=n;}),null);
__d('InitMSearchTypeahead',['$','DOM','MLegacyDataStore','MSearchTypeahead','MSearchTypeaheadLogger','MSearchTypeaheadPerfLoggerUtil','MTypeaheadNativeSource','MTypeaheadNullstateSource','MTypeaheadOnDemandSource','MTypeaheadPackagedSource','MTypeaheadTouchSource','Stratcom','TypeaheadCompositeSource','SearchMTouchGlobalOptions','FWLoader'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=c('FWLoader').FW,w,x,y,z=function aa(ba){if(w)return;w=true;x=h(ba.id);var ca=h(ba.textinput);if(ca.tagName.toLowerCase()!=='input')ca=i.find(ca,'input');y=new k(x,ca,{photoSize:ba.photoSize,reportProblemURI:ba.reportProblemURI});if(ba.mSideNavMarauderLogger)ba.mSideNavMarauderLogger.setupTypeaheadListener(y);var da,ea=[];if(ba.sources.packagedSource){da=new q(ba.sources.packagedSource.packagedresults);da.setShowSecondaryAction(ba.showSecondaryAction);ea.push(da);}if(ba.sources.nativeSource){da=new n();da.setShowSecondaryAction(ba.showSecondaryAction);ea.push(da);}if(ba.sources.bootstrapped){da=new r(ba.sources.bootstrapped.src,ba.sources.bootstrapped.source_key);da.setShowSecondaryAction(ba.showSecondaryAction);ea.push(da);}if(ba.sources.nullstate){da=new o(ba.sources.nullstate.src);da.setMaximumResultCount(ba.sources.nullstate.max_results);ea.push(da);}if(ba.sources.online){da=new p(ba.sources.online.src);if(ba.sources.online.max_results)da.setMaximumResultCount(ba.sources.online.max_results);da.setEnableImmediateReturnOfCachedResults(ba.sources.online.enable_caching);if(u.enableQueryThrottle)da.setThrottleSendRequest(u.queryThrottleTime);da.setMaxResults(u.maxResults);da.setEnableEagerSendRequest(u.enableEagerSendRequest);da.setQueryDelay(u.queryWaitTime);da.setShowSecondaryAction(ba.showSecondaryAction);ea.push(da);if(ba.sources.online.useLocation)y.addLocationAwareSource(da);}var fa=new t(ea);fa.disableEmptyMergeKey();y.setDatasource(fa);y.setPermanent(ba.permanent);if(ba.showPresence)y.showPresence=true;if(ba.typeaheadScubaInfo)m.getNewMSearchTypeaheadPerfLogger(y,ba.typeaheadScubaInfo,ba.sources.online.enable_caching);var ga='/search/metrics.php',ha=new l(y,ga);s.listen('log-m-search-session-end',null,function(ia){ha.blur(ia.getData().reason);});j.get(x).typeahead=y;s.listen('m-search-typeahead-change',null,function(ia){if(ia.getData().query!=y.getValue()){y.setValue(ia.getData().query);y.refresh();}});i.listen(x,'click','typeahead-result',function(){ca.blur();});s.listen('m:search-typeahead:clear',null,function(ia){y.setValue('');y.refresh();});s.invoke('m:search-typeahead:ready');y.start();if(ca.value!=='')y.refresh();if(window.FW_ENABLED)v.ubersearchReady();};g.main=z;}),null);